package com.integration.extensions.domains.sumologic.impl;

import java.util.HashMap;
import java.util.Map;
import com.integration.extensions.domains.sumologic.util.AlertUtil;
import com.integration.util.RestClient;

import static com.integration.extensions.domains.sumologic.impl.SumoLogicExtensionImpl.*;

class SumoLogicExtensionImplTest {

    private static String url;
    private static String token;

    public static void main(String[] args) {
        SumoLogicExtensionImpl impl = new SumoLogicExtensionImpl();
        Map<String, Object> attributes = new HashMap<>();
        token =
                "c3U5R2NSbUpucFlYb0c6VTBETG5obWdkUnE0YWZuR1VLRWxJQzVQTFBGdjFTMmdsNFpxOUdzc0NzZnlQdGVvSThnMFV6OUZnN2g5RWt1QQ==";
        url = "https://api.in.sumologic.com";

        attributes.put(ACCESS_TOKEN, token);
        attributes.put(HOST_URL, url);

        impl.init(attributes);

        RestClient restClient = new RestClient(url, token);

//        CreateSearchJob searchJob = SearchJobUtil.createSearchJob(restClient, "_sourceCategory=\"uploads/access-point\"", 1600104841000l, 1600277654000l);
//        System.out.println(new Gson().toJson(searchJob));
//        SearchJobStatus status = SearchJobUtil.getSearchJobStatus(restClient, searchJob.id);
//        System.out.println(new Gson().toJson(status));
//        List<SearchJobMessage> message = SearchJobUtil.getSearchJobMessages(restClient, searchJob.id,1,20);
//        System.out.println(new Gson().toJson(message));
//         String s ="{\"fields\":[{\"name\":\"_blockid\",\"fieldType\":\"long\",\"keyField\":false},{\"name\":\"_collector\",\"fieldType\":\"string\",\"keyField\":false},{\"name\":\"_collectorid\",\"fieldType\":\"long\",\"keyField\":false},{\"name\":\"_format\",\"fieldType\":\"string\",\"keyField\":false},{\"name\":\"_messagecount\",\"fieldType\":\"int\",\"keyField\":false},{\"name\":\"_messageid\",\"fieldType\":\"long\",\"keyField\":false},{\"name\":\"_messagetime\",\"fieldType\":\"long\",\"keyField\":false},{\"name\":\"_raw\",\"fieldType\":\"string\",\"keyField\":false},{\"name\":\"_receipttime\",\"fieldType\":\"long\",\"keyField\":false},{\"name\":\"_size\",\"fieldType\":\"long\",\"keyField\":false},{\"name\":\"_source\",\"fieldType\":\"string\",\"keyField\":false},{\"name\":\"_sourcecategory\",\"fieldType\":\"string\",\"keyField\":false},{\"name\":\"_sourcehost\",\"fieldType\":\"string\",\"keyField\":false},{\"name\":\"_sourceid\",\"fieldType\":\"long\",\"keyField\":false},{\"name\":\"_sourcename\",\"fieldType\":\"string\",\"keyField\":false},{\"name\":\"_view\",\"fieldType\":\"string\",\"keyField\":false}],\"messages\":[{\"map\":{\"_blockid\":\"-9223372036854770802\",\"_messagetime\":\"1600061540998\",\"_raw\":\"2020-08-21 16:14:10,846 WARN o.g.j.s.w.WadlFeature [main] JAXBContext implementation could not be found. WADL feature is disabled.\",\"_collectorid\":\"100237257\",\"_sourceid\":\"100294991\",\"_collector\":\"File Uploads\",\"_messagecount\":\"5338\",\"_sourcehost\":\"117.214.123.97\",\"_messageid\":\"-9223372036854714869\",\"_sourcename\":\"accesspoint.log\",\"_size\":\"130\",\"_view\":\"\",\"_receipttime\":\"1600061540998\",\"_sourcecategory\":\"uploads/access-point\",\"_format\":\"t:ac1:o:0:l:23:p:yyyy-MM-dd HH:mm:ss,SSS\",\"_source\":\"accesspoint.log\"}},{\"map\":{\"_blockid\":\"-9223372036854770802\",\"_messagetime\":\"1600061540847\",\"_raw\":\"2020-08-18 21:28:21,646 WARN o.g.j.s.w.WadlFeature [main] JAXBContext implementation could not be found. WADL feature is disabled.\",\"_collectorid\":\"100237257\",\"_sourceid\":\"100294991\",\"_collector\":\"File Uploads\",\"_messagecount\":\"4837\",\"_sourcehost\":\"117.214.123.97\",\"_messageid\":\"-9223372036854715392\",\"_sourcename\":\"accesspoint.log\",\"_size\":\"130\",\"_view\":\"\",\"_receipttime\":\"1600061540847\",\"_sourcecategory\":\"uploads/access-point\",\"_format\":\"t:ac1:o:0:l:23:p:yyyy-MM-dd HH:mm:ss,SSS\",\"_source\":\"accesspoint.log\"}},{\"map\":{\"_blockid\":\"-9223372036854770802\",\"_messagetime\":\"1600061540768\",\"_raw\":\"2020-08-14 12:11:06,173 WARN o.g.j.s.w.WadlFeature [main] JAXBContext implementation could not be found. WADL feature is disabled.\",\"_collectorid\":\"100237257\",\"_sourceid\":\"100294991\",\"_collector\":\"File Uploads\",\"_messagecount\":\"4587\",\"_sourcehost\":\"117.214.123.97\",\"_messageid\":\"-9223372036854715658\",\"_sourcename\":\"accesspoint.log\",\"_size\":\"130\",\"_view\":\"\",\"_receipttime\":\"1600061540768\",\"_sourcecategory\":\"uploads/access-point\",\"_format\":\"t:ac1:o:0:l:23:p:yyyy-MM-dd HH:mm:ss,SSS\",\"_source\":\"accesspoint.log\"}},{\"map\":{\"_blockid\":\"-9223372036854770802\",\"_messagetime\":\"1600061540728\",\"_raw\":\"2020-08-10 10:17:56,454 INFO c.k.a.a.LoggingFilter [jersey-server-managed-async-executor-7] User: unknown - Path: file/exist/doc_jar_7cc1d6c0-fe1f-455f-a0b0-c0d579082e8e.jar - Header: {Accept=[application/json], User-Agent=[Jersey/2.31 (HttpUrlConnection 11.0.6)], Host=[localhost:8089], Connection=[keep-alive]}\",\"_collectorid\":\"100237257\",\"_sourceid\":\"100294991\",\"_collector\":\"File Uploads\",\"_messagecount\":\"3947\",\"_sourcehost\":\"117.214.123.97\",\"_messageid\":\"-9223372036854716298\",\"_sourcename\":\"accesspoint.log\",\"_size\":\"312\",\"_view\":\"\",\"_receipttime\":\"1600061540728\",\"_sourcecategory\":\"uploads/access-point\",\"_format\":\"t:ac1:o:0:l:23:p:yyyy-MM-dd HH:mm:ss,SSS\",\"_source\":\"accesspoint.log\"}},{\"map\":{\"_blockid\":\"-9223372036854770802\",\"_messagetime\":\"1600061540710\",\"_raw\":\"2020-08-07 13:33:11,242 WARN o.g.j.s.w.WadlFeature [main] JAXBContext implementation could not be found. WADL feature is disabled.\",\"_collectorid\":\"100237257\",\"_sourceid\":\"100294991\",\"_collector\":\"File Uploads\",\"_messagecount\":\"3589\",\"_sourcehost\":\"117.214.123.97\",\"_messageid\":\"-9223372036854716656\",\"_sourcename\":\"accesspoint.log\",\"_size\":\"130\",\"_view\":\"\",\"_receipttime\":\"1600061540710\",\"_sourcecategory\":\"uploads/access-point\",\"_format\":\"t:ac1:o:0:l:23:p:yyyy-MM-dd HH:mm:ss,SSS\",\"_source\":\"accesspoint.log\"}},{\"map\":{\"_blockid\":\"-9223372036854770802\",\"_messagetime\":\"1600061540605\",\"_raw\":\"2020-08-04 14:12:13,625 INFO c.k.a.a.LoggingFilter [jersey-server-managed-async-executor-6] User: unknown - Path: file/exist/INV_b969bd68-7f3c-48a7-861e-17a79cf4bf32.jar - Header: {Accept=[application/json], User-Agent=[Jersey/2.31 (HttpUrlConnection 11.0.6)], Host=[localhost:8089], Connection=[keep-alive]}\",\"_collectorid\":\"100237257\",\"_sourceid\":\"100294991\",\"_collector\":\"File Uploads\",\"_messagecount\":\"2710\",\"_sourcehost\":\"117.214.123.97\",\"_messageid\":\"-9223372036854717541\",\"_sourcename\":\"accesspoint.log\",\"_size\":\"308\",\"_view\":\"\",\"_receipttime\":\"1600061540605\",\"_sourcecategory\":\"uploads/access-point\",\"_format\":\"t:ac1:o:0:l:23:p:yyyy-MM-dd HH:mm:ss,SSS\",\"_source\":\"accesspoint.log\"}},{\"map\":{\"_blockid\":\"-9223372036854770802\",\"_messagetime\":\"1600061540573\",\"_raw\":\"2020-07-30 17:31:32,799 INFO c.k.a.a.LoggingFilter [jersey-server-managed-async-executor-6] User: unknown - Path: file/exist/INV_baae46fd-d948-408d-bb63-8a4b4b3fdb01.jar - Header: {Accept=[application/json], User-Agent=[Jersey/2.31 (HttpUrlConnection 11.0.6)], Host=[localhost:8089], Connection=[keep-alive]}\",\"_collectorid\":\"100237257\",\"_sourceid\":\"100294991\",\"_collector\":\"File Uploads\",\"_messagecount\":\"1949\",\"_sourcehost\":\"117.214.123.97\",\"_messageid\":\"-9223372036854718302\",\"_sourcename\":\"accesspoint.log\",\"_size\":\"308\",\"_view\":\"\",\"_receipttime\":\"1600061540573\",\"_sourcecategory\":\"uploads/access-point\",\"_format\":\"t:ac1:o:0:l:23:p:yyyy-MM-dd HH:mm:ss,SSS\",\"_source\":\"accesspoint.log\"}},{\"map\":{\"_blockid\":\"-9223372036854770802\",\"_messagetime\":\"1600061540539\",\"_raw\":\"2020-07-28 17:36:30,469 INFO c.k.a.a.LoggingFilter [jersey-server-managed-async-executor-0] User: unknown - Path: file/exist/INV_67d8a615-9785-44a8-ae41-0c09f00a3092.jar - Header: {Accept=[application/json], User-Agent=[Jersey/2.31 (HttpUrlConnection 11.0.6)], Host=[localhost:8089], Connection=[keep-alive]}\",\"_collectorid\":\"100237257\",\"_sourceid\":\"100294991\",\"_collector\":\"File Uploads\",\"_messagecount\":\"1260\",\"_sourcehost\":\"117.214.123.97\",\"_messageid\":\"-9223372036854718991\",\"_sourcename\":\"accesspoint.log\",\"_size\":\"308\",\"_view\":\"\",\"_receipttime\":\"1600061540539\",\"_sourcecategory\":\"uploads/access-point\",\"_format\":\"t:ac1:o:0:l:23:p:yyyy-MM-dd HH:mm:ss,SSS\",\"_source\":\"accesspoint.log\"}},{\"map\":{\"_blockid\":\"-9223372036854770802\",\"_messagetime\":\"1600061540488\",\"_raw\":\"2020-07-22 19:01:12,658 INFO c.k.a.a.LoggingFilter [jersey-server-managed-async-executor-7] User: unknown - Path: file/exist/INV_6ac672f7-6089-4995-8384-4a8f7ecbb79f.jar - Header: {Accept=[application/json], User-Agent=[Jersey/2.31 (HttpUrlConnection 11.0.6)], Host=[localhost:8089], Connection=[keep-alive]}\",\"_collectorid\":\"100237257\",\"_sourceid\":\"100294991\",\"_collector\":\"File Uploads\",\"_messagecount\":\"271\",\"_sourcehost\":\"117.214.123.97\",\"_messageid\":\"-9223372036854719980\",\"_sourcename\":\"accesspoint.log\",\"_size\":\"308\",\"_view\":\"\",\"_receipttime\":\"1600061540488\",\"_sourcecategory\":\"uploads/access-point\",\"_format\":\"t:ac1:o:0:l:23:p:yyyy-MM-dd HH:mm:ss,SSS\",\"_source\":\"accesspoint.log\"}},{\"map\":{\"_blockid\":\"-9223372036854770802\",\"_messagetime\":\"1600061540474\",\"_raw\":\"2020-07-20 19:52:30,543 WARN o.g.j.s.w.WadlFeature [main] JAXBContext implementation could not be found. WADL feature is disabled.\",\"_collectorid\":\"100237257\",\"_sourceid\":\"100294991\",\"_collector\":\"File Uploads\",\"_messagecount\":\"109\",\"_sourcehost\":\"117.214.123.97\",\"_messageid\":\"-9223372036854720142\",\"_sourcename\":\"accesspoint.log\",\"_size\":\"130\",\"_view\":\"\",\"_receipttime\":\"1600061540474\",\"_sourcecategory\":\"uploads/access-point\",\"_format\":\"t:ac1:o:0:l:23:p:yyyy-MM-dd HH:mm:ss,SSS\",\"_source\":\"accesspoint.log\"}},{\"map\":{\"_blockid\":\"-9223372036854770802\",\"_messagetime\":\"1600061540466\",\"_raw\":\"2020-07-15 13:07:26,151 WARN o.g.j.s.w.WadlFeature [main] JAXBContext implementation could not be found. WADL feature is disabled.\",\"_collectorid\":\"100237257\",\"_sourceid\":\"100294991\",\"_collector\":\"File Uploads\",\"_messagecount\":\"54\",\"_sourcehost\":\"117.214.123.97\",\"_messageid\":\"-9223372036854720197\",\"_sourcename\":\"accesspoint.log\",\"_size\":\"130\",\"_view\":\"\",\"_receipttime\":\"1600061540466\",\"_sourcecategory\":\"uploads/access-point\",\"_format\":\"t:ac1:o:0:l:23:p:yyyy-MM-dd HH:mm:ss,SSS\",\"_source\":\"accesspoint.log\"}}]}\n";
//        SlSearchJobMessage m = new Gson().fromJson(s,SlSearchJobMessage.class);
//        System.out.println(new Gson().toJson(m));

//        System.out.println( CollectorUtil.getCollectors(restClient));
//        System.out.println(CollectorUtil.getCollectorById(restClient,"100237257"));
//        System.out.println(SourcesUtil.getCollectors(restClient,"100237257"));
//        System.out.println(SourcesUtil.getCollectorById(restClient,"100237257","100294991"));
        System.out.println(AlertUtil.getMonitorAlerts(restClient));
    }

}